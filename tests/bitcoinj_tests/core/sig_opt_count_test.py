import unittest
from dataclasses import dataclass

from bitcoinj.core.transaction import Transaction
from bitcoinj.params.test_net3_params import TestNet3Params
from bitcoinj.params.main_net_params import MainNetParams
from bitcoinj.core.network_parameters import NetworkParameters

 
class TransactionTest(unittest.TestCase):

    def test_transaction_sig_opts_count(self):
        # invalid tx
        tx_hex_1 = "010000000127587a10248001f424ad94bb55cd6cd6086a0e05767173bdbdf647187beca76c000000004948304502201b822ad10d6adc1a341ae8835be3f70a25201bbff31f59cbb9c5353a5f0eca18022100ea7b2f7074e9aa9cf70aa8d0ffee13e6b45dddabf1ab961bda378bcdb778fa4701ffffffff0100f2052a010000001976a914fc50c5907d86fed474ba5ce8b12a66e0a4c139d888ac00000000"
        # valid tx
        tx_hex_2 = "02000000000103adbaa1f1cc93835faac8258a5520c92f4c1e3cb0c5b570fa621a82e32a2dcdbe1c00000000ffffffffadbaa1f1cc93835faac8258a5520c92f4c1e3cb0c5b570fa621a82e32a2dcdbe2200000000ffffffffadbaa1f1cc93835faac8258a5520c92f4c1e3cb0c5b570fa621a82e32a2dcdbe5700000000ffffffffcc677401000000000017a9147bb042dff5db19765cccdeffb48d4001665749df87e9b50000000000001976a914e755a0ede22626e30f92026122224f7b5b094ce188ace85f1d00000000001600143118fc0b23e6c714183c4d94f4b71d95b0d696dde3690000000000001600146bbcd6105fb1b48c9104cff12a446c3ffe3f09ad90440000000000001600148b053c05845ba695f0d2f87c1631a5ba117368f0dd3f0200000000001976a9146973155e6e07682b4d242190c699aa72f15d2d9288ac9a170000000000001600146c0a78229ad9fccad3bdeb0097e8ea4855c6a300bcb40000000000001600147e330ae98c080690e03f5ba23e972042f31a48db5e7100000000000017a914e9577df291e71a81375d17a7f64c5af70b0a7fe687f07f01000000000017a914a77d4adb63c89ba2883213af338f4b868a4f233e87bfff02000000000016001446aec4d05756bf564197e9194a79a27b51b3a54bf63100000000000016001419f651bcb15d28af55c8f7af3b270344885cba485271000000000000160014aacf42cb74ff028e679ebaa8cdf74d37fe7c0fce2d7d0000000000001600146aa99abf3c4bf07ec9dd681153e6b3a0dbccb592b787000000000000160014dbc04fb8f01f675fbeff4bc1a65c22ab58e693a9728f000000000000160014f9f6feb00ed439b1e7256c1445965020997102869a9e0100000000001976a914f646012628f5b6686d8325daf993413f44d5ccdc88ac7d7300000000000017a914875d2bd434c3824af6f792ae7374009fb1cdae27873552000000000000160014a5c049e2b5ced8e2096212a7f435c81362e5b6a3a54200000000000017a914c54768fe9521259140e3073fc0744f86b9f5408787164500000000000016001410d7c8fadd2bfa4f18f8d8d77ede84bbb199304b1e5207000000000016001480b1071d7018daa9c00e55bd484d9d9142d15c70725f00000000000017a91453ec931a3ba43151ceb68dda20809a2158ca5a9487907f0400000000001976a914e9afdb3de423c1fe4980c3787dbfea9c38d0e18588acafa90400000000001976a91417fe4e412e445afbe806f2ed68443c1c89bca65888ac9e8701000000000022512012ad9877a75aa80c13b5aa7b257fafefac931e99d69da68c3bb4b19c48dde4a02e6a0000000000001600141b8850e13ff979d85ce05bfde126240d96cdb7b64c4800000000000016001407f2b180d4678bf9094ddfee86ccfc41b93639706b2a000000000000160014bf9bdad04868f97d93c8bd2d3d999950d07a8223ee5f00000000000016001459d0b3d76bdbdb51187dc005ef191f8a44fefbf07652000000000000160014ad89ff6dfa029093d36e92ccfb4ffb7c685e01a24e580000000000001976a914f4579853761a7a1184f73e8194554addfaccdbfd88ac75e602000000000016001472914889333cbf622454b3896b32e3265a36c8da3f67020000000000160014dac4da95f4c19f974238da188a0ba7b63a6f3712722a000000000000160014af774637add3cb4e9b87d52e558c5df423ba4f66152100000000000017a91427282c673541e3d8e56cb80f6f4e00e2b551a492874657000000000000160014e643e21536282175fe1b307e6e09caa3681a5ca995410800000000001976a914ad8c5cd5d097c0be24286c29377d8bba7f8bd32a88acd350070000000000160014f390b5d58d3f2d4b1129fbcdf93e79320fe9487dd8ab0e0000000000160014576c0478a9ee3393200155ba1a5281b77b49fac5e04c000000000000220020e14ad632dbd78f706fbaba9feffbf385dc2985c46c345a1c6d9fe6c4e0a0ceffbf38000000000000160014ef2acb88cf23fc09bbe8a1f689c890a1ccf6d9bfbe4c000000000000160014cf332f25905cbff6ea8ff99114479fba5d2df00199ec0000000000001976a9144a1b9a70243520a785ac45bf9140a77c84f1a9ce88ace9224702000000001600148ab8dcb2f7a46235f5ddafa1666f5c18c68274fd457300000000000016001454b1d91e7f6c075706514a628c74f215680ed3b265bc01000000000016001489bcf978b4f2f2654ea6cc1baddaa56555a46930df31000000000000160014d3d2b77cfa32c95593982a9dd2b65ebb134225808bcd010000000000160014b844592ff036832202075fbbdaf419c7f4f19b982d2100000000000016001455e350e8f9ceb50bf4beafc1740679a4cbdecfcec2320000000000001600141b6796a05c347c78a85daafb64a38a968c23df7674430000000000001600147dcff7cea7ccd8b07bbd41cf7f5ef8a66c4cf423e369000000000000160014e561b1d9121864a099261e129a9c2bdf517037d3f593010000000000160014e234da548dae368fa8ad5cdd135edd15472cdbe9e57f0100000000001600148c86df525d28e829d0001f85c8869824d3cea953d4b40000000000001976a9145ac4dec7cf59cda9ffd4c25e3032cbae7d4084fa88ac4bc70000000000001976a914474a4d22a80450443293bd7326108767e76cfe9f88ac7244000000000000160014722f2039794980502515bd65bd4d5bc5a5af3b13e86700000000000016001479b2b1e75153a71c4000e4528ecba6e1e2935d0c536f0000000000001600141841b138dc30ab82964277dbd5021956d5d476f843570000000000001600141ffe9cde3e77d28f48ab6bd58effc9a67c47edef9d9c020000000000160014e586f797d0de8688d3b1f426e22cba376836ad2ea0b40000000000001600147dd749390dc5f8c205dcd57f5120cb32cf8399e639dc030000000000160014f49daa0070cd93119f7a72fb13e060ff130052870e600000000000001600148001df4c6fdb4eb04ff1994ed54c62a0c7c88188421f0000000000001600146168226aad7b1b992a76802ae987e308db5d27accee80000000000001976a914de197c8032c49525fcd743f9912f2ea3cb7841b888acadbc010000000000160014c1bf77a0373b7fa8baa5d8f38518e9d41588463b81f103000000000017a914825bd7bad14335b6c885cb6937422f12a68b574987be350000000000001976a914fd13b115b55c05aaa67e29f8a8415ed66ae2596f88ac3d57000000000000160014addf2a97b9c0d23c993709f35e44d1e2c6c331733e1f000000000000160014c798f8712a55a0ec7f7560b83e364abdc785d0c1398f000000000000160014b2c3c43d63b4f4de56b5636da91a152c9e6b61eea963020000000000160014b4bc0fc7a5bfce86b0934294bb5611dde553b254518307000000000017a91422bf3b6b07a3fc06aee159b184a88f39f1c9525787c58c00000000000016001487194249c8ec42571b998f7fc1c8ed2e379a14978a1300000000000016001407787af1075ed8653ecc6fc6f4a1653540a4559a4b5800000000000017a914cf2ca25cf561e41f424d5918c7ea7e558273ec8887dc720300000000001976a9148192c428b63517e17df8960e56ca23014fb152d988acbd1e000000000000160014279972d9416b4bba5382b32b47e4599670aa9f21a4350000000000001976a9142653da4282aad70a7f6eeb1d205c544e6dccfa9788ac9f1e0000000000001976a914fd08351c8a3c3bebc7de059b4255e49079c3772488ac68b90100000000002251202685b7831ec5e68840d94e9c8b5f73125bc46eb5b5f10bccbfd390d12c4541ef758c0200000000002200204484b6ccb95389d6bdd1c5f7ef3b6e99cbb66f775daa1854f306b3c5d7332561ef7f0100000000001600145495eb947f8e113b56e9a33badfbe22dc120614ad0a21300000000001976a914a5400f79ff52db7843cfe2fb579907162aa0b7ca88ac85cc0a0000000000160014220d1a8b3c3e99adf22e1cdaae9455f51620b0d0e91f010000000000160014ac4bb14fe40b848f94eba519923f14f4828b34e8a7b400000000000017a91418aa73fb385458b385aaa597b2f9c0c0f67497f6876271000000000000160014b2522b06f5b0058f56c033f290f070a292e89c4516a2000000000000160014339c2081821cbc943091cdbc4a2924a5e0d89ab34a5403000000000017a914866c8b7e810cdd51b02445ca8c2766455820d606875fe1000000000000160014aadb1210e012d32de447f6be74ffaf86c6691efb37570000000000001976a91472f7e50ad67cb5965ec5c4b346631d5b8dad73ac88acc31800000000000016001470e54a44efc28409342cab203bfb405d3a5c9e346626000000000000160014eb9ab5c80581d73b45d29b97a51dd00e09332fd3bf4c000000000000160014675881f92eac77066aaa5bbbbfb6347cb443cb0baca30300000000001976a9140d999853932a4c81d2be77ecb32619048784d98488ace331000000000000160014ec2164b9fdffb19d98f67df3e08cdca3c0f420deb1c30000000000001600149886f4727c935b031ab3ccb6279693151b256275d8a100000000000017a9145ac93b9bee41d57d62f78a7da465b48a3b173758878fb500000000000017a914a7a935aa556555f6c262e02d9758fcc00aa0f4d187e7d90000000000001976a9149ba6e9d67d5bce70bff477aa9389868a1e0b4f6e88acb45e00000000000016001445c7328c37c77fae4f2381f65f8a3118eeaf62af30bc0000000000001976a9144026330c9826a57d75a386ea3e123c9399d2e23f88ac3657000000000000160014a49b2b362497332d5623c2b3a350666918c6a3d00379000000000000160014eede708f78063ec1b79ef24ab4a352e3548114986b4e0700000000001600149fd71cb3fdc7c617b293978f739acb206d2ab5259444000000000000160014ee5624af3abc5a77bcf5e3964e73c0ed1016fe2085cb000000000000160014cc1e01452a0076cf2b105f8eb7d8a047e0efe7d43f1f000000000000160014ff2d08a04a5345b81835df0c1a2cefd66879ca66bac40f00000000001976a914923cf56c20eddaf27668c879727b743743f2d1ff88acf5480000000000001600145717f985538b44e34666c185a8a4b75527097e3ba3350000000000001600148bcfd4383c6a5ef0e17d48c9871fed3a17dfc7f382590100000000001600146050cc6f55ad8f9b0f16ab3dff701012146db7e03661010000000000160014c936a1213c2a5e9e39e0229c6a203e518097e11c47c00000000000001976a91478371c4096cf730cfae6419240a0c049fb39b84f88acecf3060000000000225120c0e3eacbc228284f04a4783a2b6ab794822082981cc00bfcd27579bd5ba8b14da2c70000000000001600147a2370cc537f298443451be4eae743ad79e8ec22331e00000000000017a914a10584f6c73bda688d043d939a5a57a8aba9c47b87870b010000000000160014e2937d7980ed807783d51f3cbf6498615502a6adf66302000000000016001454af495588111e8e276a40f50d39894e4afd06623f8f000000000000160014fcdf8e7f9ad012c209548609e327d751336f263959fd000000000000160014c9c18180838b9285d459349f8d9664eef04b86e4b87c0000000000001600144b1ffdeff3604fe2d69f31fb1be0d77bbb1bf59b3c1b000000000000160014765aa7a4ca4e5213fb522d664a25c564fc8ae4f23d1b00000000000016001435304a89337ff66952664aaeadad01dcefbdc935f54000000000000016001452c084a32055bc3eeecc6b17037d54552a8513b0361502000000000017a914ef45ab4fd4360efdf5156785f0b3297b56d7d353876b3d0000000000001600141c851c73149d5e8e7c2468dc03dfd5719e928f18476f0100000000001600143be84032171d9ac5054c6a4c6b2178e9752ebd02b2890300000000001600141a139fed194659f7745d751ab46304b1214965313e5700000000000017a91419618bc5f94c6fde529eddb2827fe1d86446eb0a87e3250000000000001976a9142420f68fc62789ddf2b4738af54d4ffa749193cb88ac4b5800000000000017a9141ac2bf8368577c3fad0947aca187452b4d285d12876dd20000000000001976a914749bf464cc87550de12e336595823b14fccc0dbd88ac16550100000000001600140f8ddeb6e96e13785f13c94e42a313ad1f0eed3a51e600000000000017a9146491ebee531e76275377b07037b2aa448e4d472587873a000000000000160014a5ebfe6e6a0a1c46d58dff198a6c705d78eaed5d521f00000000000016001492525f1f0a59f638f0bb7748d43adf4088bbfd3694b4000000000000160014ae26a7df818dd8776de6f9fc6d08ccf11c0fc6081673000000000000160014e528cd95e2782b802d35fcce38e51de0dac5aafd485800000000000017a914bd3f4c6f0b5a43af7a58dd95fffd14ba30d623f887001400000000000017a914372d4dfa93af372b63bfc16ce5fd69b8294c1da787d2130000000000001600145edac10c76e27eaf0f595bbf7df0dc6c0c688a724bc700000000000016001444d6cd2ddccb222b4b4b802f8cad0bd3e69aaf233d570000000000002200202f6d558d5270403e8e687d7a2b8d13341831a6bdc90988780fe6aed2d9da84d529d7050000000000160014c5a72980b73c22d2a9ab71f6337a2d3360a447e90dd70500000000001600149075e8c8948e95018b9dbd8cb979ecf8e63f4572ee820000000000001600148864813b68a24a6d02186dc2be71cf163f975aad716b0000000000001976a9145d1e5587110f2984f73cee56af18786d7c6d4fb788ac3d5700000000000016001446c68811df99a2b64292d4ceab424aed4e7843a8401f0000000000001600142a0f68e155816124536e3422348e55f7677bf30964120100000000001600143c634a8f234eaf7a4ec4a21bdc6f8fc2dceec24e264f0000000000002200205c32604229ea3e5623e9b1829252864624f04796b18f4071b9179bca10e0ec08588f000000000000160014cd1c44862014ef084473b0323ce1a38d22daf287d14c00000000000017a9143733cb007bb0e28fb0b616448a8d965da5696c57876c6200000000000016001452008aecbd34e902c1fefdf95a0cda0e0d9ee054a4d80500000000001976a914ed73ba226a0ad77a468a371d8113e381a84e4cd888ac584601000000000017a914089ee17d42ea38566d26e0494aa6fb3c629c747b87c2e10000000000001600143d05799cf85f3def92f0e561a9a73670cf5daef05980000000000000160014789855fdd4eb5eb91de9fc590931afd4cda9ee6122ad000000000000160014d688e0f19e8a0de77894378c8dbab7df2a219118cbe702000000000016001477fc176dade4c18ecf2ee825dd3c6d8ff5756e98be23010000000000160014c97f0fe714b199ad6d4f030b09b8d1ec7d5eb10adc800100000000002200200b0c434a6b7014c6e2e295a95ffbd2e0ac5ff046864f353aa2581c94f415cd1c4e1f000000000000220020a237073aee32ad0fa4128e842533f28419eb208d888ba1fc937e708ef495c332e7690000000000001600143c53328714507b9a9c99255d8339259811cad4d7d6370000000000001976a914535fb307a0579e564476ebaf7b898248e7b1bd0088accf7a0000000000001976a9147f8f2e22a62271f64876559d05a9bffc1ce8fd1f88ac3b2a0000000000001600144782ff514ace6d964d09a56fb4f8ee88f2d628c73e57000000000000160014a37e8b848e855ec38170dbdba5f60585d9a24b5837f80800000000001976a914f4d09b46ac6335ae207658b0616478bb5e4303e988ac794e0700000000001976a91475d16cb3b1fdf78a7577706bc02fb77e623a28ea88ac5e510200000000001600142a6e398321a15a0e7a418029051fc9f2d655ad9b4c3d000000000000160014c5365e536f979aba051400a93ff9e5c4ae4f17cbe07201000000000016001443efade14cb3290875afabc8037e025867b0bec37071000000000000160014d8b2b92fd31c3e74466272d0b82609d050c8f70eb796000000000000160014e59fe692a8adf712834ae32b6da0e7e454e77ad295b4000000000000160014c1301bae05aa7fc715554d6262cf7d17f0655ecdaf5e0000000000001600147a85e8274e0bce1a01b29bb6332ec40c10727db8cb86000000000000160014cf6381487c179b37d87852d8d7dd8ffaf063e6efd4130000000000001600141d3326477751fceb0ddd08c739e458cf3bde9892b27c0000000000001976a9148b06aa72003e7dc4fbbf8cf129589248583e00c888ac3e570000000000001600145303b6a6c7a4150eb916581ead3c04b96a73522d379c000000000000160014580b78ca0dfdfda5643cb32243484946bd3186bd4f5800000000000016001451cd3f58451649d66a830e18b873727984e425974b28000000000000160014a3a2352508d946e04c3fd29b03b0264e27c5bcca966d000000000000160014928935aa6dbd5037901524a2ce45199f66d40932308000000000000017a91438349cce5b6afcf33b3d1cc940428cdd79f062c087f65f0000000000001600145f1a8a740975914adc17896c2f34c70d35e48458531f0000000000001976a9145bf5d5f879bddc8800ec83e05235cd29616aadc088ac9f8700000000000017a914d168575eb5267899184712673775fb92d704d5488757340000000000001600148b0bd7b8b795221030ef9604125e8420b81f30a5c8300000000000001976a91491182dbe4823e8f001e30103619eed5fbe00226e88ac3857000000000000160014b10e7f7aeaa12ecb725179b754f0e56e6fbb1481de250600000000001976a91446203f0289b375ed759a5301ef404bbd8a4ab77a88aca5240100000000001600144119ed645dd3298e3b6b514c49b9888af99332bea63500000000000017a9142beb9a8592bbe853e6ef1e1a1ccd85d64dcaec8a87c8af00000000000016001451ffb9230dba0f594263f788f5457671031ef28bc92f010000000000160014b78d234135a47c774522b53ba5e5703bb9c6f253287300000000000017a9143e9a7f5f654093748aab68ebcc7fa9db2c138e6d87cd320000000000001976a914d53e07e8c403382a5a51873095bb2d611f5e88cc88ac299e000000000000160014bc1c69fa03da56acfb976733d02e8544042d97020247304402205b62031d12c4531c958b1d4bd1099e72c3d0096ff2a64b0e4f0ef13516e2f22b02207b53f4292622751bc4f70f971e4b207611ba9dadc4436324742e2553c0d1e967012103994143a2f034fb99d0d53d5700f0bce9867ef41e8748583f8dbe5706649d1d2c0247304402203912cdf336ae0a3e33ba4870c19f6342ffbc6711225fb366e06c2ca6aae9b85102205caa37ac85c881c126d79057f7693fad328144cfac1c1723c4af97db18b3c61e012102bba84bdfe05757e1838f6ad293baaab43f8e76b10120406fd216590bbff463ec02473044022071a9a7ee01d02e3a894271f9d8f409fbf609c8bd251dc7e85e4a3d6cdc29488d022035d2d92551acd5927640cbc0a4a8999bcf5cd19751f79a9de36055028f975d13012103228513df8624d18dc73342bd35fad83235391c5f5be20d189eb1bcffedc3c09400000000"
        tx = Transaction(MainNetParams(), bytes.fromhex(tx_hex_1))
        self.assertEqual(tx.get_sig_op_count(), 1)
        tx = Transaction(MainNetParams(), bytes.fromhex(tx_hex_2))
        self.assertEqual(tx.get_sig_op_count(), 35)

if __name__ == '__main__':
    unittest.main()
  